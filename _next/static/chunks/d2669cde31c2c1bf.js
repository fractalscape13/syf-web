(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(43476),n=e.i(71645);function r(){let e="/syf-web",r=t=>{if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:")||t.startsWith("blob:"))return t;let n=t.startsWith("/")?t:`/${t}`;return`${e}${n}`},l=(0,n.useRef)(null),a=(0,n.useRef)(null),s=(0,n.useRef)(null),i=(0,n.useRef)(null),o=(0,n.useRef)([]),c=(0,n.useRef)(!1),u=(0,n.useRef)(null),d=(0,n.useRef)(new Map),f=(0,n.useRef)(null),[h,m]=(0,n.useState)(null),[x,g]=(0,n.useState)(null),[p,b]=(0,n.useState)(null),[w,v]=(0,n.useState)(null),[y,j]=(0,n.useState)(null),[k,N]=(0,n.useState)("#111827"),[M,C]=(0,n.useState)(10),[R,Y]=(0,n.useState)("move"),[X,S]=(0,n.useState)({scale:1,offsetX:0,offsetY:0});(0,n.useEffect)(()=>()=>{h&&URL.revokeObjectURL(h)},[h]);let I=!!(h&&x&&w&&o.current&&s.current&&i.current),P=(0,n.useMemo)(()=>h?x&&s.current?"":"Image is still loading":"Choose an image first",[x,h]);function O(e){return Math.min(6,Math.max(.2,e))}function T(e){S(t=>({...t,scale:O(t.scale*e)}))}let U=(0,n.useMemo)(()=>w?{w:w.width,h:w.height}:null,[w]);function E(){let e=a.current,t=s.current;if(!e||!U)return;let n=window.devicePixelRatio||1;(e.width!==Math.floor(U.w*n)||e.height!==Math.floor(U.h*n))&&(e.width=Math.floor(U.w*n),e.height=Math.floor(U.h*n));let r=e.getContext("2d");if(r){if(r.setTransform(n,0,0,n,0,0),r.clearRect(0,0,U.w,U.h),t&&x){let e=Math.max(U.w/x.width,U.h/x.height)*X.scale;r.save(),r.translate(U.w/2+X.offsetX,U.h/2+X.offsetY),r.scale(e,e),r.drawImage(t,-x.width/2,-x.height/2),r.restore()}for(let e of(r.lineCap="round",r.lineJoin="round",o.current))if(!(e.points.length<2)){r.strokeStyle=e.color,r.lineWidth=Math.max(1,e.sizeNorm*U.w),r.beginPath(),r.moveTo(e.points[0].x*U.w,e.points[0].y*U.h);for(let t=1;t<e.points.length;t++){let n=e.points[t];r.lineTo(n.x*U.w,n.y*U.h)}r.stroke()}}}function L(e){let t=a.current;if(!t||!U)return null;let n=t.getBoundingClientRect(),r=(e.clientX-n.left)/n.width,l=(e.clientY-n.top)/n.height;return Number.isFinite(r)&&Number.isFinite(l)?{x:Math.min(1,Math.max(0,r)),y:Math.min(1,Math.max(0,l))}:null}function W(e){if(c.current){c.current=!1,u.current=null;try{e.currentTarget.releasePointerCapture(e.pointerId)}catch{}}}return(0,n.useEffect)(()=>{if(!h){s.current=null,g(null),b(null),S({scale:1,offsetX:0,offsetY:0});return}let e=new Image;e.decoding="async",e.onload=()=>{s.current=e,g({width:e.naturalWidth,height:e.naturalHeight}),S({scale:1,offsetX:0,offsetY:0})},e.src=h},[h]),(0,n.useEffect)(()=>{let t=new Image;t.decoding="async";let n=r("/images/stealie.png");t.onload=()=>{i.current=t,v({width:t.naturalWidth,height:t.naturalHeight})},t.onerror=t=>{console.error("Failed to load stencil image. Path:",n,"Error:",t),console.error("basePath value:",e),console.error("NEXT_PUBLIC_BASE_PATH:","/syf-web")},t.src=n},[]),(0,n.useEffect)(()=>{E()},[U,x,h,X]),(0,t.jsxs)("div",{className:"min-h-screen bg-[#D9D9D9] font-sans text-black",children:[(0,t.jsxs)("header",{className:"mx-auto flex w-full max-w-3xl flex-col items-center gap-5 px-6 pb-6 pt-10",children:[(0,t.jsx)("h1",{className:"text-center text-[22px] font-medium leading-7 tracking-[0.3em] text-black/90",children:"STEALIE YOUR FACE"}),(0,t.jsx)("input",{ref:l,type:"file",accept:"image/*",className:"hidden",onChange:function(e){let t=e.target.files?.[0];t&&(h&&URL.revokeObjectURL(h),m(URL.createObjectURL(t)),g(null),b(null),o.current=[],S({scale:1,offsetX:0,offsetY:0}),Y("move"),e.target.value="")}}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:function(){l.current?.click()},className:"rounded-full bg-black px-5 py-2.5 text-sm font-semibold text-white shadow-sm ring-1 ring-black/10 transition hover:bg-black/90 active:translate-y-px",children:h?"Change image":"Choose image"}),(0,t.jsx)("button",{type:"button",onClick:function(){if(!h||!x||!s.current||!i.current||!U)return;let e=document.createElement("canvas");e.width=U.w,e.height=U.h;let t=e.getContext("2d");if(!t)return;let n=Math.max(U.w/x.width,U.h/x.height)*X.scale;for(let e of(t.save(),t.translate(U.w/2+X.offsetX,U.h/2+X.offsetY),t.scale(n,n),t.drawImage(s.current,-x.width/2,-x.height/2),t.restore(),t.lineCap="round",t.lineJoin="round",o.current))if(!(e.points.length<2)){t.strokeStyle=e.color,t.lineWidth=Math.max(1,e.sizeNorm*U.w),t.beginPath(),t.moveTo(e.points[0].x*U.w,e.points[0].y*U.h);for(let n=1;n<e.points.length;n++){let r=e.points[n];t.lineTo(r.x*U.w,r.y*U.h)}t.stroke()}t.drawImage(i.current,0,0,U.w,U.h),e.toBlob(e=>{if(!e)return;let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="image.png",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(t)},"image/png")},disabled:!I,title:I?"Download edited image":P,className:"rounded-full bg-transparent px-5 py-2.5 text-sm font-semibold text-black ring-1 ring-black/20 transition hover:bg-black/5 disabled:cursor-not-allowed disabled:opacity-40 active:translate-y-px",children:"Export image"})]})]}),(0,t.jsx)("main",{className:"flex items-start justify-center px-6 pb-14",children:(0,t.jsxs)("div",{className:"flex w-full max-w-3xl flex-col items-center gap-4",children:[h?(0,t.jsx)("div",{className:"w-full",children:(0,t.jsxs)("div",{className:"mx-auto grid h-12 w-full max-w-3xl grid-cols-[auto_1fr_auto] items-center gap-3 rounded-full px-2 text-sm text-black/80",children:[(0,t.jsxs)("div",{className:"flex items-center rounded-full ring-1 ring-black/20",children:[(0,t.jsx)("button",{type:"button",onClick:()=>Y("move"),className:["rounded-full px-3 py-2 text-xs font-semibold transition","move"===R?"bg-black text-white":"text-black/70 hover:bg-black/5"].join(" "),children:"Move/Zoom"}),(0,t.jsx)("button",{type:"button",onClick:()=>Y("draw"),className:["rounded-full px-3 py-2 text-xs font-semibold transition","draw"===R?"bg-black text-white":"text-black/70 hover:bg-black/5"].join(" "),children:"Draw"})]}),(0,t.jsxs)("div",{className:"relative h-full min-w-0",children:[(0,t.jsx)("div",{className:["absolute inset-0 flex items-center justify-center gap-3 transition-opacity","move"===R?"opacity-100":"pointer-events-none opacity-0"].join(" "),children:(0,t.jsxs)("div",{className:"flex items-center gap-2 rounded-full px-1 py-1 ring-1 ring-black/20",children:[(0,t.jsx)("button",{type:"button",onClick:()=>T(.9),className:"grid h-9 w-9 place-items-center rounded-full text-lg font-semibold text-black/80 transition hover:bg-black/5 active:translate-y-px","aria-label":"Zoom out",title:"Zoom out",children:"âˆ’"}),(0,t.jsxs)("span",{className:"min-w-[56px] text-center text-xs font-semibold tracking-wide text-black/70",children:[Math.round(100*X.scale),"%"]}),(0,t.jsx)("button",{type:"button",onClick:()=>T(1.1),className:"grid h-9 w-9 place-items-center rounded-full text-lg font-semibold text-black/80 transition hover:bg-black/5 active:translate-y-px","aria-label":"Zoom in",title:"Zoom in",children:"+"})]})}),(0,t.jsxs)("div",{className:["absolute inset-0 flex items-center justify-center gap-3 transition-opacity","draw"===R?"opacity-100":"pointer-events-none opacity-0"].join(" "),children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:"Brush"}),(0,t.jsx)("input",{type:"range",min:2,max:40,value:M,onChange:e=>C(Number(e.target.value)),className:"w-36"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:"Color"}),(0,t.jsx)("input",{type:"color",value:k,onChange:e=>N(e.target.value),className:"h-8 w-10 rounded-md border border-black/20 bg-transparent p-1"})]})]})]}),(0,t.jsx)("button",{type:"button",onClick:function(){o.current=[],E()},disabled:!h,className:["rounded-full px-4 py-2 text-xs font-semibold text-black ring-1 ring-black/20 transition hover:bg-black/5 disabled:cursor-not-allowed disabled:opacity-50","move"===R?"invisible":"visible"].join(" "),children:"Clear"})]})}):null,U?(0,t.jsx)("div",{className:"flex w-full justify-center",children:(0,t.jsxs)("div",{className:"relative w-full overflow-hidden",style:{width:360,maxWidth:"100%",aspectRatio:`${U.w} / ${U.h}`},children:[h?(0,t.jsx)("canvas",{ref:a,className:"absolute inset-0 h-full w-full touch-none bg-black/5",onPointerDown:e=>{if("draw"===R)return void function(e){if(!h||!U)return;let t=L(e);if(!t)return;let n={color:k,sizeNorm:M/U.w,points:[t]};u.current=n,o.current=[...o.current,n],c.current=!0,e.currentTarget.setPointerCapture(e.pointerId),E()}(e);if("move"!==R||!U)return;e.currentTarget.setPointerCapture(e.pointerId),d.current.set(e.pointerId,{x:e.clientX,y:e.clientY});let t=Array.from(d.current.values());if(1===t.length)f.current={kind:"pan",startScale:X.scale,startOffsetX:X.offsetX,startOffsetY:X.offsetY,startMidX:t[0].x,startMidY:t[0].y,startDist:0};else if(t.length>=2){let e=t[0],n=t[1],r=(e.x+n.x)/2,l=(e.y+n.y)/2,a=Math.hypot(e.x-n.x,e.y-n.y)||1;f.current={kind:"pinch",startScale:X.scale,startOffsetX:X.offsetX,startOffsetY:X.offsetY,startMidX:r,startMidY:l,startDist:a}}},onPointerMove:e=>{if("draw"===R)return void function(e){if(!c.current)return;let t=L(e),n=u.current;t&&n&&(n.points.push(t),E())}(e);if("move"!==R)return;let t=f.current;if(!t)return;d.current.set(e.pointerId,{x:e.clientX,y:e.clientY});let n=Array.from(d.current.values());if(0!==n.length){if(1===n.length&&"pan"===t.kind){let e=n[0],r=e.x-t.startMidX,l=e.y-t.startMidY;S({scale:t.startScale,offsetX:t.startOffsetX+r,offsetY:t.startOffsetY+l});return}if(n.length>=2){let e=n[0],r=n[1],l=(e.x+r.x)/2,a=(e.y+r.y)/2,s=Math.hypot(e.x-r.x,e.y-r.y)||1,i=Math.min(6,Math.max(.2,t.startScale*(s/t.startDist))),o=l-t.startMidX,c=a-t.startMidY;S({scale:i,offsetX:t.startOffsetX+o,offsetY:t.startOffsetY+c})}}},onPointerUp:e=>{W(e),d.current.delete(e.pointerId),f.current=null;try{e.currentTarget.releasePointerCapture(e.pointerId)}catch{}},onPointerCancel:e=>{W(e),d.current.delete(e.pointerId),f.current=null},onPointerLeave:e=>{W(e),d.current.delete(e.pointerId),f.current=null},onWheel:e=>{if("move"!==R)return;e.preventDefault();let t=e.deltaY<0?1.06*X.scale:.94*X.scale;S(e=>({...e,scale:O(t)}))}}):(0,t.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"linear-gradient(135deg, rgba(0,0,0,.06) 0%, rgba(0,0,0,.02) 50%, rgba(0,0,0,.06) 100%)"}}),(0,t.jsx)("img",{src:r("/images/stealie.png"),alt:"Stealie stencil",className:"pointer-events-none absolute inset-0 h-full w-full select-none object-contain",draggable:!1})]})}):null]})})]})}e.s(["default",()=>r])}]);